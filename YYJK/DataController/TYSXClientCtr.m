//
//  TYSXClientCtr.m
//  tysx
//
//  Created by zwc on 15/1/4.
//  Copyright (c) 2015年 huangjia. All rights reserved.
//

#import "TYSXClientCtr.h"
#import "NSString+JSONCategory.h"

@implementation TYSXClientCtr {
    NSMutableArray *loginArray;
    NSMutableArray *playArray;
    NSMutableArray *conversionRateArray;
    NSMutableArray *orderArray;
    NSMutableArray *realTodayArray;
    NSMutableArray *realYesterdayArray;
    NSMutableArray *topTenArray;
    NSMutableArray *topTenNameArray;
    NSMutableArray *playNumArray;
    NSMutableArray *playUserArray;
    NSMutableArray *chooseTitleArr;
    NSArray *chooseIdArray;
    NSInteger maxHourValue;
}

- (id)initWithCacheType:(CacheType)cacheType {
    if (self = [super initWithCacheType:cacheType]) {
        _selecteTopTenIndex = 7;
        //NSString *jsonStr = @"{\"lpright\":[[\"2015-01-04\",\"5101\",\"首页kv图\",111,57],[\"2015-01-04\",\"5102\",\"直播六图\",1626,1092],[\"2015-01-04\",\"5103\",\"直播频道推荐\",686,446],[\"2015-01-04\",\"5104\",\"广告位\",0,0],[\"2015-01-04\",\"5105\",\"随心看推荐\",1191,640],[\"2015-01-04\",\"5106\",\"随心看一\",971,469],[\"2015-01-04\",\"5107\",\"随心看二\",68,50],[\"2015-01-04\",\"5108\",\"随心看三\",172,67],[\"2015-01-04\",\"5109\",\"大片\",170,113],[\"2015-01-04\",\"5110\",\"微电影\",332,227],[\"2015-01-04\",\"5111\",\"股票\",0,0],[\"2015-01-04\",\"5112\",\"全能看\",0,0],[\"2015-01-04\",\"5113\",\"法律\",0,0],[\"2015-01-04\",\"5114\",\"新视觉\",0,0],[\"2015-01-04\",\"5115\",\"免费\",1370,1107],[\"2015-01-04\",\"5116\",\"精品推荐_导航1\",0,0],[\"2015-01-04\",\"5117\",\"精品推荐_导航2\",0,0],[\"2015-01-04\",\"5118\",\"汽车\",0,0],[\"2015-01-04\",\"5119\",\"随心看四\",39,25],[\"2015-01-04\",\"5120\",\"随心看五\",242,172],[\"2015-01-04\",\"5200\",\"临时精品区\",232,138],[\"2015-01-05\",\"5101\",\"首页kv图\",190,107],[\"2015-01-05\",\"5102\",\"直播六图\",2120,1457],[\"2015-01-05\",\"5103\",\"直播频道推荐\",687,427],[\"2015-01-05\",\"5104\",\"广告位\",0,0],[\"2015-01-05\",\"5105\",\"随心看推荐\",1089,640],[\"2015-01-05\",\"5106\",\"随心看一\",811,394],[\"2015-01-05\",\"5107\",\"随心看二\",64,44],[\"2015-01-05\",\"5108\",\"随心看三\",168,62],[\"2015-01-05\",\"5109\",\"大片\",187,142],[\"2015-01-05\",\"5110\",\"微电影\",254,196],[\"2015-01-05\",\"5111\",\"股票\",0,0],[\"2015-01-05\",\"5112\",\"全能看\",0,0],[\"2015-01-05\",\"5113\",\"法律\",0,0],[\"2015-01-05\",\"5114\",\"新视觉\",0,0],[\"2015-01-05\",\"5115\",\"免费\",1412,1102],[\"2015-01-05\",\"5116\",\"精品推荐_导航1\",0,0],[\"2015-01-05\",\"5117\",\"精品推荐_导航2\",0,0],[\"2015-01-05\",\"5118\",\"汽车\",0,0],[\"2015-01-05\",\"5119\",\"随心看四\",21,17],[\"2015-01-05\",\"5120\",\"随心看五\",240,173],[\"2015-01-05\",\"5200\",\"临时精品区\",272,150],[\"2015-01-06\",\"5101\",\"首页kv图\",214,127],[\"2015-01-06\",\"5102\",\"直播六图\",2170,1503],[\"2015-01-06\",\"5103\",\"直播频道推荐\",677,466],[\"2015-01-06\",\"5104\",\"广告位\",0,0],[\"2015-01-06\",\"5105\",\"随心看推荐\",1184,653],[\"2015-01-06\",\"5106\",\"随心看一\",759,366],[\"2015-01-06\",\"5107\",\"随心看二\",73,61],[\"2015-01-06\",\"5108\",\"随心看三\",206,73],[\"2015-01-06\",\"5109\",\"大片\",235,166],[\"2015-01-06\",\"5110\",\"微电影\",239,175],[\"2015-01-06\",\"5111\",\"股票\",0,0],[\"2015-01-06\",\"5112\",\"全能看\",0,0],[\"2015-01-06\",\"5113\",\"法律\",0,0],[\"2015-01-06\",\"5114\",\"新视觉\",0,0],[\"2015-01-06\",\"5115\",\"免费\",1444,1140],[\"2015-01-06\",\"5116\",\"精品推荐_导航1\",0,0],[\"2015-01-06\",\"5117\",\"精品推荐_导航2\",0,0],[\"2015-01-06\",\"5118\",\"汽车\",0,0],[\"2015-01-06\",\"5119\",\"随心看四\",15,11],[\"2015-01-06\",\"5120\",\"随心看五\",240,167],[\"2015-01-06\",\"5200\",\"临时精品区\",316,188],[\"2015-01-07\",\"5101\",\"首页kv图\",202,116],[\"2015-01-07\",\"5102\",\"直播六图\",2095,1384],[\"2015-01-07\",\"5103\",\"直播频道推荐\",663,433],[\"2015-01-07\",\"5104\",\"广告位\",0,0],[\"2015-01-07\",\"5105\",\"随心看推荐\",950,505],[\"2015-01-07\",\"5106\",\"随心看一\",736,343],[\"2015-01-07\",\"5107\",\"随心看二\",65,48],[\"2015-01-07\",\"5108\",\"随心看三\",204,62],[\"2015-01-07\",\"5109\",\"大片\",167,118],[\"2015-01-07\",\"5110\",\"微电影\",274,171],[\"2015-01-07\",\"5111\",\"股票\",0,0],[\"2015-01-07\",\"5112\",\"全能看\",0,0],[\"2015-01-07\",\"5113\",\"法律\",0,0],[\"2015-01-07\",\"5114\",\"新视觉\",0,0],[\"2015-01-07\",\"5115\",\"免费\",1337,1039],[\"2015-01-07\",\"5116\",\"精品推荐_导航1\",0,0],[\"2015-01-07\",\"5117\",\"精品推荐_导航2\",0,0],[\"2015-01-07\",\"5118\",\"汽车\",0,0],[\"2015-01-07\",\"5119\",\"随心看四\",27,21],[\"2015-01-07\",\"5120\",\"随心看五\",116,99],[\"2015-01-07\",\"5200\",\"临时精品区\",392,214],[\"2015-01-08\",\"5101\",\"首页kv图\",257,150],[\"2015-01-08\",\"5102\",\"直播六图\",1888,1274],[\"2015-01-08\",\"5103\",\"直播频道推荐\",734,427],[\"2015-01-08\",\"5104\",\"广告位\",0,0],[\"2015-01-08\",\"5105\",\"随心看推荐\",971,526],[\"2015-01-08\",\"5106\",\"随心看一\",2113,373],[\"2015-01-08\",\"5107\",\"随心看二\",82,62],[\"2015-01-08\",\"5108\",\"随心看三\",132,48],[\"2015-01-08\",\"5109\",\"大片\",109,79],[\"2015-01-08\",\"5110\",\"微电影\",198,145],[\"2015-01-08\",\"5111\",\"股票\",0,0],[\"2015-01-08\",\"5112\",\"全能看\",0,0],[\"2015-01-08\",\"5113\",\"法律\",0,0],[\"2015-01-08\",\"5114\",\"新视觉\",0,0],[\"2015-01-08\",\"5115\",\"免费\",1256,951],[\"2015-01-08\",\"5116\",\"精品推荐_导航1\",0,0],[\"2015-01-08\",\"5117\",\"精品推荐_导航2\",0,0],[\"2015-01-08\",\"5118\",\"汽车\",0,0],[\"2015-01-08\",\"5119\",\"随心看四\",46,32],[\"2015-01-08\",\"5120\",\"随心看五\",287,147],[\"2015-01-08\",\"5200\",\"临时精品区\",324,198],[\"2015-01-09\",\"5101\",\"首页kv图\",179,104],[\"2015-01-09\",\"5102\",\"直播六图\",2127,1366],[\"2015-01-09\",\"5103\",\"直播频道推荐\",868,480],[\"2015-01-09\",\"5104\",\"广告位\",0,0],[\"2015-01-09\",\"5105\",\"随心看推荐\",1251,766],[\"2015-01-09\",\"5106\",\"随心看一\",671,320],[\"2015-01-09\",\"5107\",\"随心看二\",63,48],[\"2015-01-09\",\"5108\",\"随心看三\",187,55],[\"2015-01-09\",\"5109\",\"大片\",142,99],[\"2015-01-09\",\"5110\",\"微电影\",228,172],[\"2015-01-09\",\"5111\",\"股票\",0,0],[\"2015-01-09\",\"5112\",\"全能看\",0,0],[\"2015-01-09\",\"5113\",\"法律\",0,0],[\"2015-01-09\",\"5114\",\"新视觉\",0,0],[\"2015-01-09\",\"5115\",\"免费\",1204,929],[\"2015-01-09\",\"5116\",\"精品推荐_导航1\",0,0],[\"2015-01-09\",\"5117\",\"精品推荐_导航2\",0,0],[\"2015-01-09\",\"5118\",\"汽车\",0,0],[\"2015-01-09\",\"5119\",\"随心看四\",36,27],[\"2015-01-09\",\"5120\",\"随心看五\",163,121],[\"2015-01-09\",\"5200\",\"临时精品区\",303,179],[\"2015-01-10\",\"5101\",\"首页kv图\",151,68],[\"2015-01-10\",\"5102\",\"直播六图\",1278,881],[\"2015-01-10\",\"5103\",\"直播频道推荐\",514,315],[\"2015-01-10\",\"5104\",\"广告位\",0,0],[\"2015-01-10\",\"5105\",\"随心看推荐\",794,487],[\"2015-01-10\",\"5106\",\"随心看一\",548,198],[\"2015-01-10\",\"5107\",\"随心看二\",56,39],[\"2015-01-10\",\"5108\",\"随心看三\",132,51],[\"2015-01-10\",\"5109\",\"大片\",73,54],[\"2015-01-10\",\"5110\",\"微电影\",122,100],[\"2015-01-10\",\"5111\",\"股票\",0,0],[\"2015-01-10\",\"5112\",\"全能看\",0,0],[\"2015-01-10\",\"5113\",\"法律\",0,0],[\"2015-01-10\",\"5114\",\"新视觉\",0,0],[\"2015-01-10\",\"5115\",\"免费\",703,510],[\"2015-01-10\",\"5116\",\"精品推荐_导航1\",0,0],[\"2015-01-10\",\"5117\",\"精品推荐_导航2\",0,0],[\"2015-01-10\",\"5118\",\"汽车\",0,0],[\"2015-01-10\",\"5119\",\"随心看四\",14,8],[\"2015-01-10\",\"5120\",\"随心看五\",120,73],[\"2015-01-10\",\"5200\",\"临时精品区\",196,78]],\"lptop\":[[\"2015-01-04\",24939,60122,0.4148,0,0,0],[\"2015-01-05\",23242,54528,0.4262,26356,10905,15451],[\"2015-01-05\",23242,54528,0.4262,26356,12385,13971],[\"2015-01-05\",23242,54528,0.4262,26356,13556,12800],[\"2015-01-05\",23242,54528,0.4262,26356,18458,7898],[\"2015-01-05\",23242,54528,0.4262,26356,10905,15451],[\"2015-01-05\",23242,54528,0.4262,26356,16210,10146],[\"2015-01-05\",23242,54528,0.4262,26356,10905,15451],[\"2015-01-05\",23242,54528,0.4262,26356,12385,13971],[\"2015-01-05\",23242,54528,0.4262,26356,18458,7898],[\"2015-01-05\",23242,54528,0.4262,26356,10232,16124],[\"2015-01-05\",23242,54528,0.4262,26356,13556,12800],[\"2015-01-05\",23242,54528,0.4262,26356,9547,16809],[\"2015-01-05\",23242,54528,0.4262,26356,16210,10146],[\"2015-01-05\",23242,54528,0.4262,26356,10905,15451],[\"2015-01-06\",23851,57067,0.4179,25669,2793,22876],[\"2015-01-06\",23851,57067,0.4179,24860,14236,10624],[\"2015-01-06\",23851,57067,0.4179,24860,11568,13292],[\"2015-01-06\",23851,57067,0.4179,24860,17066,7794],[\"2015-01-06\",23851,57067,0.4179,24860,19517,5343],[\"2015-01-06\",23851,57067,0.4179,25669,1546,24123],[\"2015-01-06\",23851,57067,0.4179,25669,1918,23751],[\"2015-01-06\",23851,57067,0.4179,25669,2179,23490],[\"2015-01-06\",23851,57067,0.4179,25669,2363,23306],[\"2015-01-06\",23851,57067,0.4179,24860,5001,19859],[\"2015-01-06\",23851,57067,0.4179,24860,5987,18873],[\"2015-01-06\",23851,57067,0.4179,24860,10148,14712],[\"2015-01-06\",23851,57067,0.4179,24860,13082,11778],[\"2015-01-06\",23851,57067,0.4179,24860,3344,21516],[\"2015-01-06\",23851,57067,0.4179,24860,9263,15597],[\"2015-01-06\",23851,57067,0.4179,24860,7855,17005],[\"2015-01-06\",23851,57067,0.4179,25669,2522,23147],[\"2015-01-06\",23851,57067,0.4179,24860,4185,20675],[\"2015-01-06\",23851,57067,0.4179,24860,12267,12593],[\"2015-01-06\",23851,57067,0.4179,24860,5987,18873],[\"2015-01-07\",23486,56134,0.4184,24090,2492,21598],[\"2015-01-07\",23486,56134,0.4184,24010,11391,12619],[\"2015-01-07\",23486,56134,0.4184,24010,7541,16469],[\"2015-01-07\",23486,56134,0.4184,24090,2709,21381],[\"2015-01-07\",23486,56134,0.4184,24010,3226,20784],[\"2015-01-07\",23486,56134,0.4184,24010,11391,12619],[\"2015-01-07\",23486,56134,0.4184,24010,11391,12619],[\"2015-01-07\",23486,56134,0.4184,24090,2136,21954],[\"2015-01-07\",23486,56134,0.4184,24090,2318,21772],[\"2015-01-07\",23486,56134,0.4184,24010,10645,13365],[\"2015-01-07\",23486,56134,0.4184,24010,11391,12619],[\"2015-01-07\",23486,56134,0.4184,24090,1484,22606],[\"2015-01-07\",23486,56134,0.4184,24090,1876,22214],[\"2015-01-07\",23486,56134,0.4184,24010,9320,14690],[\"2015-01-07\",23486,56134,0.4184,24010,3993,20017],[\"2015-01-07\",23486,56134,0.4184,24010,4743,19267],[\"2015-01-07\",23486,56134,0.4184,24010,5831,18179],[\"2015-01-07\",23486,56134,0.4184,24010,8578,15432],[\"2015-01-07\",23486,56134,0.4184,24010,9957,14053],[\"2015-01-07\",23486,56134,0.4184,24010,11391,12619],[\"2015-01-07\",23486,56134,0.4184,24010,5831,18179],[\"2015-01-08\",22915,55880,0.4101,23526,0,23526],[\"2015-01-08\",22915,55880,0.4101,23526,20203,3323],[\"2015-01-08\",22915,55880,0.4101,23526,8944,14582],[\"2015-01-08\",22915,55880,0.4101,23526,9683,13843],[\"2015-01-08\",22915,55880,0.4101,23526,10536,12990],[\"2015-01-08\",22915,55880,0.4101,23526,13676,9850],[\"2015-01-08\",22915,55880,0.4101,23526,13676,9850],[\"2015-01-08\",22915,55880,0.4101,23546,0,23546],[\"2015-01-08\",22915,55880,0.4101,23546,0,23546],[\"2015-01-08\",22915,55880,0.4101,23546,0,23546],[\"2015-01-08\",22915,55880,0.4101,23546,0,23546],[\"2015-01-08\",22915,55880,0.4101,23526,15165,8361],[\"2015-01-08\",22915,55880,0.4101,23526,13064,10462],[\"2015-01-08\",22915,55880,0.4101,23526,16212,7314],[\"2015-01-08\",22915,55880,0.4101,23546,0,23546],[\"2015-01-08\",22915,55880,0.4101,23526,11581,11945],[\"2015-01-08\",22915,55880,0.4101,23526,12434,11092],[\"2015-01-08\",22915,55880,0.4101,23546,0,23546],[\"2015-01-08\",22915,55880,0.4101,23526,18264,5262],[\"2015-01-08\",22915,55880,0.4101,23526,0,23526],[\"2015-01-09\",26441,62650,0.422,23417,10769,12648],[\"2015-01-09\",26441,62650,0.422,23417,13144,10273],[\"2015-01-09\",26441,62650,0.422,23668,4223,19445],[\"2015-01-09\",26441,62650,0.422,23417,8218,15199],[\"2015-01-09\",26441,62650,0.422,23417,9276,14141],[\"2015-01-09\",26441,62650,0.422,23417,10075,13342],[\"2015-01-09\",26441,62650,0.422,23417,11430,11987],[\"2015-01-09\",26441,62650,0.422,23417,17304,6113],[\"2015-01-09\",26441,62650,0.422,23668,3158,20510],[\"2015-01-09\",26441,62650,0.422,23417,11430,11987],[\"2015-01-09\",26441,62650,0.422,23668,2579,21089],[\"2015-01-09\",26441,62650,0.422,23668,3728,19940],[\"2015-01-09\",26441,62650,0.422,23417,5018,18399],[\"2015-01-09\",26441,62650,0.422,23417,6518,16899],[\"2015-01-09\",26441,62650,0.422,23417,14381,9036],[\"2015-01-09\",26441,62650,0.422,23417,19914,3503],[\"2015-01-09\",26441,62650,0.422,23668,2950,20718],[\"2015-01-09\",26441,62650,0.422,23668,3329,20339],[\"2015-01-09\",26441,62650,0.422,23417,5786,17631],[\"2015-01-09\",26441,62650,0.422,23417,6518,16899],[\"2015-01-09\",26441,62650,0.422,23668,3329,20339],[\"2015-01-10\",18300,66980,0.2732,23200,3262,19938],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,23200,3477,19723],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,23200,2519,20681],[\"2015-01-10\",18300,66980,0.2732,23200,2990,20210],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,23200,3927,19273],[\"2015-01-10\",18300,66980,0.2732,23200,4508,18692],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,24280,5441,18839],[\"2015-01-10\",18300,66980,0.2732,23200,3477,19723]],\"dgright\":[[\"2015-01-07\",\"随心看·天翼视讯实惠包\",57,\"客户端5.0预装渠道_客户端预装_天翼视讯\",25,\"谁与她同床\",5,\"百视通\",23],[\"2015-01-07\",\"TV189院线\",25,\"视讯推广_百度市场新客户端_天翼视讯\",10,\"新大头儿子和小头爸爸之秘密计划\",4,\"乐视\",11],[\"2015-01-07\",\"全能看（自订购）\",11,\"视讯中心_腾讯应用宝市场新客户端_天翼视讯\",7,\"安徽卫视\",3,\"北京容纳\",10],[\"2015-01-07\",\"乐视影视\",6,\"视讯推广_360软件市场新客户端_天翼视讯\",7,\"欲望歌手\",2,\"天翼视讯（原创）\",8],[\"2015-01-07\",\"慈文影视\",5,\"视讯中心_华为智慧云推广_天翼视讯\",5,\"男子欲奸污侄子女友被揍破相\",2,\"CCTV\",7],[\"2015-01-07\",\"中国影视院线\",3,\"视讯中心_运营支撑部推广_全能看\",5,\"一个人的武林\",2,\"天下友谊\",7],[\"2015-01-07\",\"股票老左\",3,\"视讯推广_天翼空间新客户端_天翼视讯\",5,\"明星辣妈猛赚钱 自爆快速赚钱经\",2,\"华视网聚\",6],[\"2015-01-07\",\"CCTV\",2,\"视讯推广_安卓市场新客户端_天翼视讯\",4,\"猎艳秘笈：床单上的情感猎手\",2,\"央广视讯\",5],[\"2015-01-07\",\"精品微电影\",2,\"天翼视讯运营_4X升级新客户端推广_天翼视讯\",3,\"《假面骑士》最后的龙骑\",2,\"优酷\",5],[\"2015-01-07\",\"天翼视讯纪实频道\",1,\"天翼视讯运营_号百CPA114广告联盟导航类新客户端推广1_天翼视讯\",3,\"女子体检口吐活虫护士被吓晕\",2,\"CRI国视\",5]],\"dgleft\":[[1,0,140],[2,51,68],[3,0,74],[4,0,43],[5,0,86]],\"dgtop\":[[\"2015-01-04\",1188,0,0,0],[\"2015-01-05\",1096,1297,827,470],[\"2015-01-05\",1096,1297,902,395],[\"2015-01-05\",1096,1297,986,311],[\"2015-01-05\",1096,1297,1274,23],[\"2015-01-05\",1096,1297,760,537],[\"2015-01-05\",1096,1297,1100,197],[\"2015-01-05\",1096,1297,827,470],[\"2015-01-05\",1096,1297,902,395],[\"2015-01-05\",1096,1297,1274,23],[\"2015-01-05\",1096,1297,695,602],[\"2015-01-05\",1096,1297,986,311],[\"2015-01-05\",1096,1297,604,693],[\"2015-01-05\",1096,1297,1100,197],[\"2015-01-05\",1096,1297,760,537],[\"2015-01-06\",1122,1205,176,1029],[\"2015-01-06\",1122,1169,1106,63],[\"2015-01-06\",1122,1169,868,301],[\"2015-01-06\",1122,1210,1210,0],[\"2015-01-06\",1122,1366,1366,0],[\"2015-01-06\",1122,1205,0,1205],[\"2015-01-06\",1122,1205,55,1150],[\"2015-01-06\",1122,1205,102,1103],[\"2015-01-06\",1122,1205,134,1071],[\"2015-01-06\",1122,1169,314,855],[\"2015-01-06\",1122,1169,438,731],[\"2015-01-06\",1122,1169,671,498],[\"2015-01-06\",1122,1169,1028,141],[\"2015-01-06\",1122,1169,230,939],[\"2015-01-06\",1122,1169,567,602],[\"2015-01-06\",1122,1169,493,676],[\"2015-01-06\",1122,1205,159,1046],[\"2015-01-06\",1122,1169,265,904],[\"2015-01-06\",1122,1169,946,223],[\"2015-01-06\",1122,1169,368,801],[\"2015-01-07\",1028,1142,187,955],[\"2015-01-07\",1028,1135,999,136],[\"2015-01-07\",1028,1135,562,573],[\"2015-01-07\",1028,1142,216,926],[\"2015-01-07\",1028,1135,252,883],[\"2015-01-07\",1028,1135,1069,66],[\"2015-01-07\",1028,1210,1210,0],[\"2015-01-07\",1028,1142,125,1017],[\"2015-01-07\",1028,1142,160,982],[\"2015-01-07\",1028,1135,802,333],[\"2015-01-07\",1028,1135,986,149],[\"2015-01-07\",1028,1142,0,1142],[\"2015-01-07\",1028,1142,82,1060],[\"2015-01-07\",1028,1135,681,454],[\"2015-01-07\",1028,1135,304,831],[\"2015-01-07\",1028,1135,358,777],[\"2015-01-07\",1028,1135,487,648],[\"2015-01-07\",1028,1135,620,515],[\"2015-01-07\",1028,1135,749,386],[\"2015-01-07\",1028,1135,857,278],[\"2015-01-07\",1028,1135,415,720],[\"2015-01-08\",1033,1082,234,848],[\"2015-01-08\",1033,1103,1103,0],[\"2015-01-08\",1033,1082,316,766],[\"2015-01-08\",1033,1082,365,717],[\"2015-01-08\",1033,1082,422,660],[\"2015-01-08\",1033,1082,661,421],[\"2015-01-08\",1033,1082,736,346],[\"2015-01-08\",1033,1109,124,985],[\"2015-01-08\",1033,1109,154,955],[\"2015-01-08\",1033,1109,172,937],[\"2015-01-08\",1033,1109,209,900],[\"2015-01-08\",1033,1082,811,271],[\"2015-01-08\",1033,1082,609,473],[\"2015-01-08\",1033,1082,896,186],[\"2015-01-08\",1033,1109,79,1030],[\"2015-01-08\",1033,1082,478,604],[\"2015-01-08\",1033,1082,544,538],[\"2015-01-08\",1033,1109,188,921],[\"2015-01-08\",1033,1082,981,101],[\"2015-01-08\",1033,1082,277,805],[\"2015-01-09\",1134,1061,670,391],[\"2015-01-09\",1134,1061,870,191],[\"2015-01-09\",1134,1075,210,865],[\"2015-01-09\",1134,1061,458,603],[\"2015-01-09\",1134,1061,540,521],[\"2015-01-09\",1134,1061,595,466],[\"2015-01-09\",1134,1061,783,278],[\"2015-01-09\",1134,1088,1088,0],[\"2015-01-09\",1134,1075,106,969],[\"2015-01-09\",1134,1061,741,320],[\"2015-01-09\",1134,1075,0,1075],[\"2015-01-09\",1134,1075,183,892],[\"2015-01-09\",1134,1061,241,820],[\"2015-01-09\",1134,1061,401,660],[\"2015-01-09\",1134,1061,968,93],[\"2015-01-09\",1134,1236,1236,0],[\"2015-01-09\",1134,1075,66,1009],[\"2015-01-09\",1134,1075,159,916],[\"2015-01-09\",1134,1061,291,770],[\"2015-01-09\",1134,1061,345,716],[\"2015-01-09\",1134,1075,134,941],[\"2015-01-10\",1331,1030,163,867],[\"2015-01-10\",1331,1760,1760,0],[\"2015-01-10\",1331,1065,544,521],[\"2015-01-10\",1331,1065,958,107],[\"2015-01-10\",1331,1266,1266,0],[\"2015-01-10\",1331,1439,1439,0],[\"2015-01-10\",1331,1030,204,826],[\"2015-01-10\",1331,1065,636,429],[\"2015-01-10\",1331,1030,0,1030],[\"2015-01-10\",1331,1030,93,937],[\"2015-01-10\",1331,1065,433,632],[\"2015-01-10\",1331,1065,1042,23],[\"2015-01-10\",1331,1030,239,791],[\"2015-01-10\",1331,1030,262,768],[\"2015-01-10\",1331,1065,341,724],[\"2015-01-10\",1331,1065,735,330],[\"2015-01-10\",1331,1148,1148,0],[\"2015-01-10\",1331,1601,1601,0],[\"2015-01-10\",1331,1065,291,774],[\"2015-01-10\",1331,1065,846,219],[\"2015-01-10\",1331,1030,223,807]],\"lpleft\":[[1,0,1682],[2,903,1015],[3,738,754],[4,665,648],[5,789,836]]}";
        //responeData = [jsonStr JSONValue];
    }
    return self;
}

- (void)setSelectedMainType:(int)selectedMainType {
    if (_selectedMainType != selectedMainType) {
        _selectedMainType = selectedMainType;
        _selectedPlayType = 0;
        _selectedTopTenType = 0;
        [self reloadRealData];
    }
}

- (void)setSelectedTopTenType:(int)selectedTopTenType {
    if (_selectedTopTenType != selectedTopTenType) {
        _selectedTopTenType = selectedTopTenType;
        [self reloadTopTenData];
    }
}

- (void)setSelectedPlayType:(int)selectedPlayType {
    if (_selectedPlayType != selectedPlayType) {
        _selectedPlayType = selectedPlayType;
        [self reloadPlayData];
    }
}

- (void)setSelecteTopTenIndex:(NSInteger)selecteTopTenIndex {
    if (_selecteTopTenIndex != selecteTopTenIndex) {
        _selecteTopTenIndex = selecteTopTenIndex;
        [self reloadTopTenData];
    }
}

- (void)allocDataContainer {
    realTodayArray = [NSMutableArray array];
    realYesterdayArray = [NSMutableArray array];
    loginArray = [NSMutableArray array];
    playArray = [NSMutableArray array];
    playUserArray = [NSMutableArray array];
    playNumArray = [NSMutableArray array];
    conversionRateArray = [NSMutableArray array];
    orderArray = [NSMutableArray array];
    topTenArray = [NSMutableArray array];
    topTenNameArray = [NSMutableArray array];
    chooseTitleArr = [NSMutableArray array];
}

- (void)clearDataContainer {
    [realTodayArray removeAllObjects];
    [realYesterdayArray removeAllObjects];
    [loginArray removeAllObjects];
    [playArray removeAllObjects];
    [conversionRateArray removeAllObjects];
    [orderArray removeAllObjects];
    [chooseTitleArr removeAllObjects];
}

- (void)reloadTopTenData {
    [topTenArray removeAllObjects];
    [topTenNameArray removeAllObjects];
    topTenNameArray = [@[@"", @"", @"", @"", @"", @"", @"", @"", @"", @""] mutableCopy];
    topTenArray = [@[@0, @0, @0, @0, @0, @0, @0, @0, @0, @0] mutableCopy];
    NSArray *dataList = nil;
    NSDictionary *dataDic = (NSDictionary *)responeData;
    
    dataList = dataDic[@"dgright"];
    
    NSDate *selecteDate = [NSDate dateWithTimeInterval:-3600 * 24 * (8 - _selecteTopTenIndex) sinceDate:lastDate];
    NSString *selectedDateString = stringWithDate(selecteDate);
    
    NSInteger currentReplaceIndex = 0;
    for (int i = 0; i < [dataList count]; i++) {
        NSArray *cellData = dataList[i];
        if ([cellData[0] isEqualToString:selectedDateString]) {
            [topTenNameArray replaceObjectAtIndex:currentReplaceIndex withObject:cellData[_selectedTopTenType * 2 + 1]];
            [topTenArray replaceObjectAtIndex:currentReplaceIndex withObject:cellData[_selectedTopTenType * 2 + 2]];
            currentReplaceIndex++;
        }
    }
}

- (void)reloadPlayData {
    [playNumArray removeAllObjects];
    [playUserArray removeAllObjects];
    
    if (kNeedVirtualData) {
        for (int i = 0; i < 9; i++) {
            [playNumArray addObject:[NSNumber numberWithInt:arc4random() % 500]];
            [playUserArray addObject:[NSNumber numberWithInt:arc4random() % 500]];
        }
        return;
    }
    
    playNumArray = [@[@0, @0, @0, @0, @0, @0, @0, @0, @0] mutableCopy];
    playUserArray = [@[@0, @0, @0, @0, @0, @0, @0, @0, @0] mutableCopy];
    NSDictionary *dataDic = (NSDictionary *)responeData;
    NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
    [dateFormat setDateFormat:@"yyyy-MM-dd"];
    NSArray *playData = [dataDic objectForKey:@"lpright"];
    
    NSString *playId = @"";
    if ([chooseIdArray count] > 0) {
        playId = chooseIdArray[_selectedPlayType];
    }
    
    for (int i = 0; i < [playData count]; i++) {
        NSArray *cellData = playData[i];
        int index = 8 - ([[dateFormat dateFromString:self.lastDateStr] timeIntervalSince1970] - [[dateFormat dateFromString:cellData[0]] timeIntervalSince1970]) / 3600 / 24;
        if (index < 0 || index > 8) {
            continue;
        }
        if ([cellData[1] isEqualToString:playId]) {
            [playNumArray replaceObjectAtIndex:index withObject:cellData[3]];
            [playUserArray replaceObjectAtIndex:index withObject:cellData[4]];
        }
    }
}

- (void)reloadRealData {
    NSDictionary *dataDic = (NSDictionary *)responeData;
    
    NSString *dataKey = nil;
    if (_selectedMainType == 0) {
        dataKey = @"lpleft";
    }
    else {
        dataKey = @"dgleft";
    }
    
    NSArray *realTimeData = [dataDic objectForKey:dataKey];
    realTodayArray = [@[@0, @0, @0, @0,@0, @0, @0, @0,@0, @0, @0, @0,@0, @0, @0, @0,@0, @0, @0, @0,@0, @0, @0, @0] mutableCopy];
    realYesterdayArray = [@[@0, @0, @0, @0,@0, @0, @0, @0,@0, @0, @0, @0,@0, @0, @0, @0,@0, @0, @0, @0,@0, @0, @0, @0] mutableCopy];
    maxHourValue = 0;
    for (int i = 0; i < [realTimeData count]; i++) {
        NSArray *cellData = realTimeData[i];
        int index = [cellData[1] intValue];
        if ([cellData[0] isEqualToString:self.lastDateStr]) {
            [realTodayArray replaceObjectAtIndex:index withObject:cellData[2]];
            maxHourValue = MAX(maxHourValue, index);
        }
        else {
            [realYesterdayArray replaceObjectAtIndex:index withObject:cellData[2]];
        }
    }
    maxHourValue += 1;
}

- (void)reloadData {
    [super reloadData];
    
    NSDictionary *dataDic = (NSDictionary *)responeData;
    loginArray = [@[@0, @0, @0, @0,@0, @0, @0, @0, @0] mutableCopy];
    playArray = [@[@0, @0, @0, @0,@0, @0, @0, @0, @0] mutableCopy];
    conversionRateArray = [@[@0, @0, @0, @0,@0, @0, @0, @0,@0] mutableCopy];
    NSArray *leftTopData = [dataDic objectForKey:@"lptop"];
    
    NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
    [dateFormat setDateFormat:@"yyyy-MM-dd"];
    
    for (int i = 0; i < [leftTopData count]; i++) {
        NSArray *cellData = leftTopData[i];
        int index = 8 - ([[dateFormat dateFromString:self.lastDateStr] timeIntervalSince1970] - [[dateFormat dateFromString:cellData[0]] timeIntervalSince1970]) / 3600 / 24;
        if (index < 0 || index > 8) {
            continue;
        }
        [loginArray replaceObjectAtIndex:index withObject:cellData[2]];
        [playArray replaceObjectAtIndex:index withObject:cellData[1]];
        [conversionRateArray replaceObjectAtIndex:index withObject:cellData[3]];
    }
    
    orderArray = [@[@0, @0, @0, @0,@0, @0, @0, @0,@0] mutableCopy];
    NSArray *rightTopData = [dataDic objectForKey:@"dgtop"];
    
    for (int i = 0; i < [rightTopData count]; i++) {
        NSArray *cellData = rightTopData[i];
        int index = 8 - ([[dateFormat dateFromString:self.lastDateStr] timeIntervalSince1970] - [[dateFormat dateFromString:cellData[0]] timeIntervalSince1970]) / 3600 / 24;
        if (index < 0 || index > 8) {
            continue;
        }
        [orderArray replaceObjectAtIndex:index withObject:cellData[1]];
    }
    [self reloadTopTenData];
    
    [self reloadRealData];
    
    NSArray *chooseData = dataDic[@"lpright"];
    NSMutableDictionary *chooseListDic = [NSMutableDictionary dictionary];
    for (int i = 0; i < [chooseData count]; i++) {
        NSArray *cellData = chooseData[i];
        [chooseListDic setValue:cellData[2] forKey:cellData[1]];
    }
    
    chooseIdArray = [[chooseListDic allKeys] sortedArrayUsingComparator:^NSComparisonResult(id obj1, id obj2) {
        return [obj1 intValue] > [obj2 intValue];
    }];
    for (int i = 0; i < [chooseIdArray count]; i++) {
        [chooseTitleArr addObject:[NSString stringWithFormat:@"%@:%@", chooseIdArray[i], chooseListDic[chooseIdArray[i]]]];
    }
    
    [self reloadPlayData];
}

- (NSInteger)maxHour {
    if (kNeedVirtualData) {
        return 13;
    }
    return maxHourValue;
}

- (NSArray *)chooseTitleList {
    if (kNeedVirtualData) {
        return @[@"1001:项目一", @"1002:项目二",@"1003:项目三",@"1004:项目四",@"1005:项目五",@"1006:项目六",@"1007:项目七",@"1008:项目八"];
    }
    return chooseTitleArr;
}

- (NSArray *)loginData {
    if (kNeedVirtualData) {
        return   @[@253, @219, @205, @72, @144, @88, @97, @261, @215];
    }
    return loginArray;
}

- (NSArray *)playData {
    if (kNeedVirtualData) {
        return @[@160, @70, @154, @160, @80, @52, @118, @240, @72];
    }
    return playArray;
}

- (NSArray *)conversionRateData {
    if (kNeedVirtualData) {
        return @[@0.1, @0.31, @0.12, @0.23, @0.15, @0.32,@0.42, @0.15, @0.14];
    }
    return conversionRateArray;
}

- (NSArray *)orderData {
    if (kNeedVirtualData) {
        return @[@254, @213, @218, @173, @189, @242, @211, @245, @202];
    }
    return orderArray;
}

- (NSArray *)realTodayData {
    if (kNeedVirtualData) {
        return @[@253, @219, @205, @72, @144, @88, @97, @261, @215, @222, @37, @169, @277, @264, @149, @26, @187, @227, @181, @249, @292, @74, @167, @17];
    }
    return realTodayArray;
}

- (NSArray *)realYesterdayData {
    if (kNeedVirtualData) {
        return @[@160, @70, @154, @160, @80, @52, @118, @240, @72, @153, @224, @282, @229, @240, @209, @145, @234, @85, @278, @126, @254, @167, @248, @61];
    }
    return realYesterdayArray;
}

- (NSArray *)playNumData {
    return playNumArray;
}

- (NSArray *)playUserData {
    return playUserArray;
}

- (NSArray *)topTenNameList {
    if (kNeedVirtualData) {
        return @[@"项目一", @"项目二", @"项目三", @"项目四", @"项目五", @"项目六", @"项目七", @"项目八", @"项目九", @"项目十"];
    }
    return topTenNameArray;
}

- (NSArray *)topTenData {
    if (kNeedVirtualData) {
        NSArray *ret = nil;
        switch (_selectedTopTenType) {
            case 0:
                ret = @[@521, @456, @540, @483, @435, @580, @513, @443, @411, @428];
                break;
            case 1:
                ret = @[@506, @598, @576, @489, @465, @424, @446, @516, @560, @427];
                break;
            case 2:
                ret = @[@505, @426, @478, @589, @555, @505, @413, @401, @517, @419];
                break;
            case 3:
                ret = @[@585, @462, @440, @435, @454, @405, @478, @484, @569, @550];
                break;
            default:
                break;
        }
        return [ret sortedArrayUsingComparator:^NSComparisonResult(id obj1, id obj2) {
            return obj1 < obj2;
        }];
    }
    return topTenArray;
}


+ (NSString *)path {
    return @"/chartsAction!getData.ds";
}

- (NSDictionary *)configParams {
    endDateStr = stringWithDate([NSDate dateWithTimeIntervalSinceNow:0]);
    startDateStr = stringWithDate([NSDate dateWithTimeIntervalSinceNow:-24 * 3600 * 8]);
    willShowDate = [NSDate dateWithTimeIntervalSinceNow:0];
    return @{@"dtype":@3,
             @"sdate":startDateStr,
             @"edate":endDateStr};
}

- (void)successWithResponse:(id)responseObject {
    _resultInfo = @"该天无网络数据";
    NSDictionary *responseDic = (NSDictionary *)responseObject;
    lastDate = willShowDate;
    _result = NetworkBaseResult_Success;
    _resultInfo = @"成功获取网络数据";
    responeData = responseDic;
}

@end
